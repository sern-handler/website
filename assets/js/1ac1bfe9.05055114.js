"use strict";(self.webpackChunk_sern_website=self.webpackChunk_sern_website||[]).push([[8811],{7348:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>u,frontMatter:()=>t,metadata:()=>l,toc:()=>c});var s=i(4848),r=i(8453);const t={sidebar_position:6},o="Plugins",l={id:"guide/walkthrough/plugins",title:"Plugins",description:"TLDR: Plugins help reduce code repetition and are installable via sern plugins. Put them onto the plugins field of a command/event module.",source:"@site/docs/guide/walkthrough/plugins.md",sourceDirName:"guide/walkthrough",slug:"/guide/walkthrough/plugins",permalink:"/docs/guide/walkthrough/plugins",draft:!1,unlisted:!1,editUrl:"https://github.com/sern-handler/website/edit/main/docs/guide/walkthrough/plugins.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"First Event Module",permalink:"/docs/guide/walkthrough/first-event"},next:{title:"Services",permalink:"/docs/guide/walkthrough/services"}},d={},c=[{value:"Installing",id:"installing",level:2},{value:"\u2517|\uff40O\u2032|\u251b perfect, your first plugin!",id:"o-perfect-your-first-plugin",level:4},{value:"Creating your own plugins",id:"creating-your-own-plugins",level:2},{value:"The controller object",id:"the-controller-object",level:3},{value:"Init Plugins",id:"init-plugins",level:2},{value:"Event Plugins",id:"event-plugins",level:2}];function a(e){const n={admonition:"admonition",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"plugins",children:"Plugins"}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["TLDR: Plugins help reduce code repetition and are installable via ",(0,s.jsx)(n.code,{children:"sern plugins"}),". Put them onto the plugins field of a command/event module."]})}),"\n",(0,s.jsx)(n.h2,{id:"installing",children:"Installing"}),"\n",(0,s.jsx)(n.p,{children:"Chances are, you just want your bot to work. Plugins can preprocess and create reusable conditions for modules."}),"\n",(0,s.jsx)(n.p,{children:"run:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"sern plugins\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Install your favorite(s) (or the ones that look the coolest). In my imaginary mind, I installed the ownerOnly plugin.\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["This should install in ",(0,s.jsx)(n.code,{children:"plugins"})," directory in ",(0,s.jsx)(n.code,{children:"src"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Some plugins only work with specific types. Most are targeted towards slash / both modules."}),"\n",(0,s.jsx)(n.li,{children:"Add to your module."}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { commandModule, CommandType } from '@sern/handler'\nimport { ownerOnly } from '../plugins'\n\nexport default commandModule({ \n    type: CommandType.Both,\n    plugins: [ownerOnly(['182326315813306368')],\n    description: 'ping command',\n    execute: (ctx) => {\n        ctx.reply('hello, owner');\n    }\n})\n\n"})}),"\n",(0,s.jsx)(n.h4,{id:"o-perfect-your-first-plugin",children:"\u2517|\uff40O\u2032|\u251b perfect, your first plugin!"}),"\n",(0,s.jsx)(n.h2,{id:"creating-your-own-plugins",children:"Creating your own plugins"}),"\n",(0,s.jsx)(n.p,{children:"The controller determines in plugins whether to continue or fail."}),"\n",(0,s.jsx)(n.h3,{id:"the-controller-object",children:"The controller object"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"export interface Controller {\n  next: () => Ok<void>;\n  stop: () => Err<void>;\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"init-plugins",children:"Init Plugins"}),"\n",(0,s.jsxs)(n.p,{children:["Init plugins modify how commands are loaded or do preprocessing.\nAn instance of the above object is passed into every plugin. ",(0,s.jsx)(n.br,{}),"\nThis controls whether a module is stored into sern. ",(0,s.jsx)(n.br,{})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { CommandInitPlugin } from '@sern/handler'\nimport path from 'path'\nexport const inDir = (dir: string) => {\n    return CommandInitPlugin(({ module, absPath }) => {\n       if(path.dirname(absPath) !== dir) {\n          console.log(+new Date(),  `${module.name} is not in the correct directory!`);\n          return controller.stop()\n       }\n       console.log(+new Date(),  `${module.name} is in the correct directory!`);\n       return controller.next(); //continue\n    });\n}\n\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Above, this simple plugin logs that the module has been loaded along with a timestamp. ",(0,s.jsx)(n.br,{})]}),"\n",(0,s.jsx)(n.h2,{id:"event-plugins",children:"Event Plugins"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.img,{alt:"control-plugins",src:i(3478).A+""})," ",(0,s.jsx)(n.br,{})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"An event is emitted by discord.js."}),"\n",(0,s.jsxs)(n.li,{children:["This event is passed to all plugins (",(0,s.jsx)(n.strong,{children:"in order!!"}),"),"]}),"\n",(0,s.jsx)(n.li,{children:"If all are successful,"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The command is executed. Calling ",(0,s.jsx)(n.code,{children:"controller.stop()"})," notifies sern that this command should not be run,\nand command is ignored."]}),"\n",(0,s.jsx)(n.p,{children:"Can you predict the behavior of this command?"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Before loading into sern, this command module will check if this module is in the correct directory ",(0,s.jsx)(n.code,{children:"other"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Before an event occurs, this command module will check if the user has the id ",(0,s.jsx)(n.code,{children:"182326315813306368"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsx)(n.p,{children:"Event Plugins are good for filtering, preconditions, parsing."})}),"\n",(0,s.jsxs)(n.p,{children:["If all plugins return ",(0,s.jsx)(n.code,{children:"controller.next()"}),", this command replies ",(0,s.jsx)(n.code,{children:"Pong \ud83c\udfd3"})]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},3478:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/eventplugins.drawio-f22ee78041e60a62a45024f542a2b104.svg"},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>l});var s=i(6540);const r={},t=s.createContext(r);function o(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);